html_text
res2<-try(SecondaryDepartment[jj]<-ii %>%
html() %>%
html_nodes('#pagecontents tr:nth-child(2) div') %>%
html_text,silent=TRUE)
if (inherits(res2,'try-error')){
SecondaryDepartment[jj] <- 'No'
}else{
SecondaryDepartment[jj]<-ii %>%
html() %>%
html_nodes('#pagecontents tr:nth-child(2) div') %>%
html_text
}
AverageGrade[jj] <- GradeLinks2[jj] %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) td+ td') %>%
html_text
#for (kk in TempHist){
#}
jj<-jj+1
}
rownames(df)<-categories
df$ECTS <- ECTS
df$CourseType <- CourseType
df$Department <- gsub('[\r\n]','',Department)
df$SecondaryDepartment <- gsub('[\r\n]','',SecondaryDepartment)
AverageGradeTemp <- gsub('[\r\n (Efter7 trinsskalaen) ]','',AverageGrade)
df$AverageGrade <- gsub('-','',AverageGradeTemp)
df[1]
df[2]
df[3]
df[4]
df[5]
df[6]
df[5]
as.numeric(df[5])
as.list(df[5])
a<-as.list(df[5])
a
a[1]
a[[1]]
as.numeric(a[[1]])
lol <- gsub('[\r\n (Efter7 trinsskalaen) ]','',AverageGrade)
lol
lol2<-gsub('-','',lol)
lol2
lol3 <- gsub(',','.',lol2)
lol3
as.numeric(lol3)
rm(list=ls())
require(rvest)
url<- 'http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E&YearGroup=2014-2015,2015-2016&btnSearch=Search'
categories <- url %>%
html() %>%
html_nodes('#ctl00_PlaceHolderMain_PageHtml td div a') %>%
html_text()
categories<-unique(categories[200:210])
departments <- url %>%
html() %>%
html_nodes('#lstDepartment option') %>%
html_text()
categories
rm(list=ls())
require(rvest)
## Fall semester
url<- 'http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E&YearGroup=2014-2015,2015-2016&btnSearch=Search'
categories <- url %>%
html() %>%
html_nodes('#ctl00_PlaceHolderMain_PageHtml td div a') %>%
html_text()
categories<-unique(categories[200:210])
departments <- url %>%
html() %>%
html_nodes('#lstDepartment option') %>%
html_text()
#Initialazing the data frame
Period <- 'Winter-2014'
df <- data.frame(matrix(nrow=length(categories),ncol=0))
CourseNum <- substring(categories,1,5)
GeneralLinks <- paste('http://www.kurser.dtu.dk/',CourseNum,'.aspx?menulanguage=en-gb',sep='')
GradeLinks <- paste('http://www.kurser.dtu.dk/courses/',CourseNum,'/info/default.aspx',sep='')
GradeLinks2 <- paste('http://karakterer.dtu.dk/Histogram/1/',CourseNum,'/',Period,sep='')
jj <- 1
CourseType <- rep(0,length(GeneralLinks))
ECTS <- rep(0,length(GeneralLinks))
Department <- rep(0,length(GeneralLinks))
SecondaryDepartment <- rep(0,length(GeneralLinks))
AverageGrade <- rep(0,length(GeneralLinks))
#TempHist <- rep(0,c(100,100))
for (ii in GeneralLinks){
res<-try(ECTS[jj]<-ii %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) .value') %>%
html_text,silent=TRUE)
if (inherits(res,'try-error')){
ECTS[jj]<-ii %>%
html() %>%
html_nodes('.normal+ table tr:nth-child(4) .value') %>%
html_text
}else{
ECTS[jj]<-ii %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) .value') %>%
html_text
}
CourseTypeTemp <- ii %>%
html() %>%
html_nodes('.value div:nth-child(1)') %>%
html_text
CourseType[jj] <- CourseTypeTemp[1]
Department[jj] <- ii %>%
html() %>%
html_nodes('.SubTableLevel2 tr:nth-child(1) .page+ td') %>%
html_text
res2<-try(SecondaryDepartment[jj]<-ii %>%
html() %>%
html_nodes('#pagecontents tr:nth-child(2) div') %>%
html_text,silent=TRUE)
if (inherits(res2,'try-error')){
SecondaryDepartment[jj] <- 'No'
}else{
SecondaryDepartment[jj]<-ii %>%
html() %>%
html_nodes('#pagecontents tr:nth-child(2) div') %>%
html_text
}
AverageGrade[jj] <- GradeLinks2[jj] %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) td+ td') %>%
html_text
#for (kk in TempHist){
res3<-try(SecondaryDepartment[jj]<-ii %>%
html() %>%
html_nodes('#pagecontents tr:nth-child(2) div') %>%
html_text,silent=TRUE)
if (inherits(res3,'try-error')){
SecondaryDepartment[jj] <- 'No'
}else{
SecondaryDepartment[jj]<-ii %>%
html() %>%
html_nodes('#pagecontents tr:nth-child(2) div') %>%
html_text
}
#}
jj<-jj+1
}
rownames(df)<-categories
df$ECTS <- ECTS
df$CourseType <- CourseType
df$Department <- gsub('[\r\n]','',Department)
df$SecondaryDepartment <- gsub('[\r\n]','',SecondaryDepartment)
AverageGradeTemp <- gsub('[\r\n (Efter7 trinsskalaen) ]','',AverageGrade)
AverageGradeTemp <- gsub(',','.',AverageGradeTemp)
df$AverageGrade <- gsub('-','',AverageGradeTemp)
rm(list=ls())
require(rvest)
## Fall semester
url<- 'http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E&YearGroup=2014-2015,2015-2016&btnSearch=Search'
categories <- url %>%
html() %>%
html_nodes('#ctl00_PlaceHolderMain_PageHtml td div a') %>%
html_text()
categories<-unique(categories[200:210])
departments <- url %>%
html() %>%
html_nodes('#lstDepartment option') %>%
html_text()
#Initialazing the data frame
rm(list=ls())
require(rvest)
## Fall semester
url<- 'http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E&YearGroup=2014-2015,2015-2016&btnSearch=Search'
categories <- url %>%
html() %>%
html_nodes('#ctl00_PlaceHolderMain_PageHtml td div a') %>%
html_text()
categories<-unique(categories[200:210])
departments <- url %>%
html() %>%
html_nodes('#lstDepartment option') %>%
html_text()
rm(list=ls())
require(rvest)
url<- 'http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E&YearGroup=2014-2015,2015-2016&btnSearch=Search'
categories <- url %>%
html() %>%
html_nodes('#ctl00_PlaceHolderMain_PageHtml td div a') %>%
html_text()
categories<-unique(categories[200:210])
departments <- url %>%
html() %>%
html_nodes('#lstDepartment option') %>%
html_text()
12*30+7*10+2*10+10*15+4*10+7*5+7*10+10*10+4*5+4*5+10*10
985/120
rm(list=ls())
urls <- paste0('http://stat.columbia.edu/~rachel/datasets/nyt',as.character(1:31),'.csv')
data1 <- read.csv(url('http://stat.columbia.edu/~rachel/datasets/nyt1.csv'))
limits <- c(-Inf,18,24,34,44,54,64,Inf)
str(data1)
data1$Agecut <- cut(data1$Age,limits)
data1
head(data1)
summaryBy
library('doBy')
summaryBy
summaryBy(Age,data=data1)
str(data1)
summaryBy(Age,data=data1)
summaryBy(Age+Gender,data=data1)
summaryBy(Gender,data=data1)
summaryBy(Gender~Age,data=data1)
summaryBy(Age~Gender,data=data1)
siterange <- function(x){c(length(x),min(x),mean(x),max(x))}
summaryBy(Age~Gender,data=data1,FUN=siterange)
rm(list=ls())
setwd('C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject')
setwd('C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject')
load('DATA3_1')
load('DATA3_2')
load('DATA3_1')
x <- append(TotalData)
x <-list()
append(x,TotalData)
x <- append(x,TotalData)
load('DATA3_2')
x <- append(x,TotalData)
x
length(x)
ls()
paste0('DATA3_',as.character(1:18))
Filenames <- paste0('DATA3_',as.character(1:18))
Filenames
TotalList
load('DATA1_3')
load('DATA3_1')
TotalList
Data <- list()
for (ii in Filenames){
load(Filenames)
Data <- append(Data,TotalData)
}
Data <- list()
for (ii in Filenames){
load(ii)
Data <- append(Data,TotalData)
}
length(Data)
data.frame(Data)
library(dplyr)
library(ggplot2)
library(reshape2)
setwd('C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject')
tbl_df(Data)
rm(list=ls())
library(dplyr)
library(ggplot2)
library(reshape2)
setwd('C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject')
load('DATA1')
load('DATA2')
Filenames <- paste0('DATA3_',as.character(1:18))
Data <- list()
for (ii in Filenames){
load(ii)
Data <- append(Data,TotalData)
}
lapply(Data, function(x) x[names(x)=='Summer-2006'])
lapply(Data, function(x) x[names(x)=='Winter-2012'])
Data$62717
Data$'62717'
Data$'62896'
rm(list=ls())
rm(list=ls())
library(dplyr)
library(ggplot2)
library(reshape2)
setwd('C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject')
load('DATA1')
load('DATA2')
Filenames <- paste0('DATA3_',as.character(1:18))
lapply(Filenames, function(x) {
load(x)
Data <- append(Data, TotalData)
})
Data <- list()
lapply(Filenames, function(x) {
load(x)
Data <- append(Data, TotalData)
})
rm(list=ls())
library(dplyr)
library(ggplot2)
library(reshape2)
setwd('C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject')
load('DATA1')
load('DATA2')
Filenames <- paste0('DATA3_',as.character(1:18))
Data <- list()
lapply(Filenames, function(x) {
load(x)
Data <- append(Data, TotalData)
})
Data <- lapply(Filenames, function(x) {
load(x)
Data <- append(Data, TotalData)
})
Filenames
Data
length(Data)
rm(list=ls())
library(dplyr)
library(ggplot2)
library(reshape2)
setwd('C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject')
load('DATA1')
load('DATA2')
Filenames <- paste0('DATA3_',as.character(1:18))
Data <- lapply(Filenames,function(fn) {
load(fn)
return (TotalData)
})
Data
length(Data)
Data <- unlist(Data,recursive=FALSE)
length(Data)
Data
rm(list=ls())
library(dplyr)
library(ggplot2)
library(reshape2)
setwd('C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject')
load('DATA1')
load('DATA2')
Filenames <- paste0('DATA3_',as.character(1:18))
Data <- list()
Data <- lapply(Filenames, function(x) {
load(x)
Data <- append(Data, TotalData)
})
Data <- unlist(Data,recursive=FALSE)
Data
length(Data <- unlist(Data,recursive=FALSE))
length(Data)
Data
rm(list=ls())
library(dplyr)
library(ggplot2)
library(reshape2)
setwd('C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject')
load('DATA1')
load('DATA2')
Filenames <- paste0('DATA3_',as.character(1:18))
Data <- lapply(Filenames,function(fn) {load(fn) return (TotalData)})
Data <- unlist(Data,recursive=FALSE)
Data <- list()
Data <- lapply(Filenames,function(fn) {load(fn) return (TotalData)})
Data <- unlist(Data,recursive=FALSE)
rm(list=ls())
library(dplyr)
library(ggplot2)
library(reshape2)
setwd('C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject')
load('DATA1')
load('DATA2')
Filenames <- paste0('DATA3_',as.character(1:18))
Data <- lapply(Filenames,function(fn) {
load(fn)
return (TotalData)
})
Data <- unlist(Data,recursive=FALSE)
Data
a<-data.frame(DATA1)
Data <- tbl_df(a)
DataCourse <- tbl_df(a)
DataCourse
library('doBy')
summaryBy(Department,DataCourse,FUN=length)
DataCourse
str(DataCourse)
summaryBy(Department,DataCourse,FUN=length)
typeof(DataCourse)
urls <- paste0('http://stat.columbia.edu/~rachel/datasets/nyt',as.character(1:31),'.csv')
data1 <- read.csv(url('http://stat.columbia.edu/~rachel/datasets/nyt1.csv'))
limits <- c(-Inf,18,24,34,44,54,64,Inf)
typeof(data1)
str(data1)
str(dataCourse)
str(DataCourse)
summaryBy(Age,data1,length)
summaryBy(Age~Age,data1,length)
summaryBy(Age~Clicks,data1,length)
summaryBy(Age~Clicks,data1,length)
data1
str(DataCourse)
str(data1)
summaryBy(Age,data1)
summaryBy(Age~Gender,data1)
summaryBy(Age~Gender,data1,length)
siterange <- function(x){c(length(x))}
summaryBy(Age~Gender,data1,FUN = length)
summaryBy(Age,data1,FUN = length)
str(DATA1)
summaryBy(Departnment,DATA1,FUN = length)
summaryBy(Departnment~ECTS,DATA1,FUN = length)
summaryBy(Course~ECTS,DATA1,FUN = length)
summaryBy(Course~Department,DATA1,FUN = length)
summaryBy(Course~Department,DATA1)
DataCourse
summaryBy(Course~Department,DataCourse)
summaryBy(Course~Department,DataCourse,FUN = length)
summaryBy(Department,DataCourse,FUN = length)
nrow(filter(DataCourse,CourseType=='BSc'))
remove(data1)
str(DataCourse)
rm(list=ls())
load('DATA1')
remove('DATA1')
rm(list=ls())
require(rvest)
library(stringi)
library(RCurl)
library(rlist)
setwd('C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject')
source('GetUrlData.R')
##link
url<-paste0('http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;',
'E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E;F1;F2;F3;F4;F5;F1A;F2A;F3A;F4A;F5A;F1B;',
'F2B;F3B;F4B;F5B;F&YearGroup=2014-2015,2015-2016&btnSearch=Search&menulanguage=en-GB')
url2 <-'http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E,E1;E1A;E1B,E2;E2A;E2B,E3;E3A;E3B,E4;E4A;E4B,E5;E5A;E5B,F1;F2;F3;F4;F5;F1A;F2A;F3A;F4A;F5A;F1B;F2B;F3B;F4B;F5B;F,F1;F1A;F1B,F2;F2A;F2B,F3;F3A;F3B,F4;F4A;F4B,F5;F5A;F5B,January,August;July;SummerSchool;June,August,July,June,SummerSchool&YearGroup=2014-2015,2015-2016&btnSearch=Search'
## States
#first page(number)
state_GetCourse<-'#ctl00_PlaceHolderMain_PageHtml td div a'
state_GetDepartments <- '#lstDepartment option'
state_GetECTS <- 'h2+ table tr:nth-child(4) .value'
state_GetECTS2 <- '.normal+ table tr:nth-child(4) .value'
state_CourseTypr <- '.value div:nth-child(1)'
state_CourseTypr2 <-'.normal+ table tr:nth-child(5) .value'
state_GetDepartment <- '.SubTableLevel2 tr:nth-child(1) .page+ td'
state_GetDepartmentSecondary <- 'tr:nth-child(2) div'
#second page(information)
state_PeriodNumber <- 'span td+ td'
##Third page
state_GetGradeTable <- 'td tr+ tr td:nth-child(2)'
#state_Attendants <- 'h2+ table td+ td'
state_Attendants <-'h2+ table tr:nth-child(4) td+ td , h2+ table tr:nth-child(3) td+ td , h2+ table tr:nth-child(2) td+ td , h2+ table tr:nth-child(1) td+ td'
## Get courses
categories<-GetUrlData(urlPath=url2,state=state_GetCourse)
categories<-unique(categories)
## Get Departments
depatments<-GetUrlData(urlPath=url,state=state_GetDepartments)
## get courses number
CourseNum <- substring(categories,1,5)
CourseNum <- unique(CourseNum)
##Initialazing the data frame
df <- data.frame(matrix(nrow=length(categories),ncol=0))
## Get Links
CourseInfoLinks <- paste('http://www.kurser.dtu.dk/',CourseNum,'.aspx?menulanguage=en-gb',sep='')
GradeLinks <- paste('http://www.kurser.dtu.dk/courses/',CourseNum,'/info/default.aspx',sep='')
CourseType <- rep(0,length(CourseInfoLinks))
ECTS <- rep(0,length(CourseInfoLinks))
Department <- rep(0,length(CourseInfoLinks))
SecondaryDepartment <- rep(0,length(CourseInfoLinks))
jj <- 1
for (ii in CourseInfoLinks){
if (url.exists(ii)){
#get ECTS credits
res<-try(ECTS[jj]<-GetUrlData(urlPath=ii,state_GetECTS),silent=TRUE)
resB<-try(ECTS[jj]<-GetUrlData(urlPath=ii,state_GetECTS2),silent=TRUE)
if (inherits(res,'try-error')){
ECTS[jj]<- GetUrlData(urlPath=ii,state_GetECTS2)
}else if(inherits(resB,'try-error')){
ECTS[jj]<-GetUrlData(urlPath=ii,state_GetECTS)
}else{
ECTS[jj]<-NA
}
#get CourseType credits
res2 <- try(CourseType[jj]<-GetUrlData(urlPath=ii,state_CourseTypr),silent=TRUE)
if (inherits(res2,'try-error')){
CourseType[jj] <- NA
}else{
CourseTypeTemp <- GetUrlData(urlPath=ii,state_CourseTypr)
CourseType[jj] <- CourseTypeTemp[1]
}
# get Deparment and secondary
res3 <- try(Department[jj]<-GetUrlData(urlPath=ii,state_GetDepartment),silent=TRUE)
if (inherits(res3,'try-error')){
Department[jj] <- NA
}else{
Department[jj] <- GetUrlData(urlPath=ii,state_GetDepartment)
}
res4<-try(SecondaryDepartment[jj]<-GetUrlData(urlPath=ii,state_GetDepartmentSecondary),silent=TRUE)
if (inherits(res4,'try-error')){
SecondaryDepartment[jj] <- 'No'
}else{
SecondaryDepartment[jj]<-GetUrlData(urlPath=ii,state_GetDepartmentSecondary)
}
}else{
ECTS[jj]<- NA
CourseType[jj]<- NA
Department[jj]<- NA
SecondaryDepartment[jj]<- NA
}
ECTS[jj] <- gsub(',','.',ECTS[jj])
Department[jj] <- gsub('[\r\n ]',' ',Department[jj])
SecondaryDepartment[jj] <- gsub('[\r\n ]',' ',SecondaryDepartment[jj])
jj<-jj+1
}
DATA4 <- list(Course=CourseNum, ECTS=ECTS,CourseType=CourseType, Department=Department, SecondaryDepartment=SecondaryDepartment)
head(DATA4)
save('DATA4',7file='C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject/DATA4')
save('DATA4',file='C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject/DATA4')
