df$AverageGrade <- AverageGrade
AverageGrade <- rep(0,length(GeneralLinks))
for (ii in GeneralLinks){
res<-try(ECTS[jj]<-ii %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) .value') %>%
html_text,silent=TRUE)
if (inherits(res,'try-error')){
ECTS[jj]<-ii %>%
html() %>%
html_nodes('.normal+ table tr:nth-child(4) .value') %>%
html_text
}else{
ECTS[jj]<-ii %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) .value') %>%
html_text
}
CourseTypeTemp <- ii %>%
html() %>%
html_nodes('.value div:nth-child(1)') %>%
html_text
CourseType[jj] <- CourseTypeTemp[1]
Department[jj] <- ii %>%
html() %>%
html_nodes('.SubTableLevel2 tr:nth-child(1) .page+ td') %>%
html_text
AverageGrade[jj] <- GradeLinks2[jj] %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) td+ td') %>%
html_text
#for (kk in TempHist){
#}
jj<-jj+1
}
AverageGrade
link <- 'http://karakterer.dtu.dk/Histogram/1/02819/Winter-2014'
lol <- link %>%
html() %>%
html_nodes('td tr+ tr td:nth-child(2) , td tr+ tr td:nth-child(1)') %>%
html_text
lol
length(lol)
lol <- link %>%
html() %>%
html_nodes('td tr+ tr td:nth-child(2) , td tr+ tr td:nth-child(1)') %>%
html_table
lol
lol[1]
lol[2]
lol2<-gsub('[\r\n]','',lol)
lol2
lol2[1]
lol3<-gsub(' ','',lol)
lol3
lol4<-gsub(' ','',lol2)
lol4
categories
ECTS
CourseType
Department
x<- gsub('[\r\n]','',Department)
x
lol
x2<- gsub('[\r\n ]','',lol)
x2
AverageGrade
x3<- gsub('[\r\n ]','',AverageGrade)
x3
x4<- gsub('[\r\n (Efter7-trinsskalaen)]','',AverageGrade)
x4
x5<- gsub('[\r\n (Efte-trinsskalaen)]','',AverageGrade)
x5
x5<- gsub('[\r\n (Efte-trinsskalaen)- ]','',AverageGrade)
x5<- gsub('[\r\n (Efter7 trinsskalaen) ]','',AverageGrade)
x5
x5<- gsub('[\r\n - (Efter7 trinsskalaen) ]','',AverageGrade)
x5
x5<- gsub('[\r\n :-: (Efter7 trinsskalaen) ]','',AverageGrade)
x5
x5<- gsub('[:-:]','',AverageGrade)
x5
x5<- gsub('[:punct:]','',AverageGrade)
x5
x5<- gsub('[\r\n :-: (Efter7 trinsskalaen) ]','',AverageGrade)
x5
gsub('-','',x5)
x5<- gsub('[\r\n :-: (Efter7 trinsskalaen) ] - ','',AverageGrade)
x5
df
tr:nth-child(2) div
require(rvest)
## Fall semester
url<- 'http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E&YearGroup=2014-2015,2015-2016&btnSearch=Search'
categories <- url %>%
html() %>%
html_nodes('#ctl00_PlaceHolderMain_PageHtml td div a') %>%
html_text()
categories<-unique(categories[200:210])
departments <- url %>%
html() %>%
html_nodes('#lstDepartment option') %>%
html_text()
#Initialazing the data frame
Period <- 'Winter-2014'
df <- data.frame(matrix(nrow=length(categories),ncol=0))
CourseNum <- substring(categories,1,5)
GeneralLinks <- paste('http://www.kurser.dtu.dk/',CourseNum,'.aspx?menulanguage=en-gb',sep='')
GradeLinks <- paste('http://www.kurser.dtu.dk/courses/',CourseNum,'/info/default.aspx',sep='')
GradeLinks2 <- paste('http://karakterer.dtu.dk/Histogram/1/',CourseNum,'/',Period,sep='')
jj <- 1
CourseType <- rep(0,length(GeneralLinks))
ECTS <- rep(0,length(GeneralLinks))
Department <- rep(0,length(GeneralLinks))
SecondaryDepartment <- rep(0,length(GeneralLinks))
AverageGrade <- rep(0,length(GeneralLinks))
#TempHist <- rep(0,c(100,100))
for (ii in GeneralLinks){
res<-try(ECTS[jj]<-ii %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) .value') %>%
html_text,silent=TRUE)
if (inherits(res,'try-error')){
ECTS[jj]<-ii %>%
html() %>%
html_nodes('.normal+ table tr:nth-child(4) .value') %>%
html_text
}else{
ECTS[jj]<-ii %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) .value') %>%
html_text
}
CourseTypeTemp <- ii %>%
html() %>%
html_nodes('.value div:nth-child(1)') %>%
html_text
CourseType[jj] <- CourseTypeTemp[1]
Department[jj] <- ii %>%
html() %>%
html_nodes('.SubTableLevel2 tr:nth-child(1) .page+ td') %>%
html_text
res2<-try(SecondaryDepartment[jj]<-ii %>%
html() %>%
html_nodes('#pagecontents tr:nth-child(2) div') %>%
html_text,silent=TRUE)
if (inherits(res2,'try-error')){
SecondaryDepartment[jj] <- 'No'
}else{
SecondaryDepartment[jj]<-ii %>%
html() %>%
html_nodes('#pagecontents tr:nth-child(2) div') %>%
html_text
}
AverageGrade[jj] <- GradeLinks2[jj] %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) td+ td') %>%
html_text
#for (kk in TempHist){
#}
jj<-jj+1
}
rownames(df)<-categories
df$ECTS <- ECTS
df$CourseType <- CourseType
df$Department <- gsub('[\r\n]','',Department)
df$SecondaryDepartment <- gsub('[\r\n]','',SecondaryDepartment)
AverageGradeTemp <- gsub('[\r\n (Efter7 trinsskalaen) ]','',AverageGrade)
df$AverageGrade <- gsub('-','',AverageGrade)
df
df[1]
df[2]
df[3]
df[4]
df[5]
df$AverageGrade <- gsub('-','',AverageGradeTemp)
df[5]
require(rvest)
## Fall semester
url<- 'http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E&YearGroup=2014-2015,2015-2016&btnSearch=Search'
categories <- url %>%
html() %>%
html_nodes('#ctl00_PlaceHolderMain_PageHtml td div a') %>%
html_text()
categories<-unique(categories[200:210])
departments <- url %>%
html() %>%
html_nodes('#lstDepartment option') %>%
html_text()
#Initialazing the data frame
Period <- 'Winter-2014'
df <- data.frame(matrix(nrow=length(categories),ncol=0))
CourseNum <- substring(categories,1,5)
GeneralLinks <- paste('http://www.kurser.dtu.dk/',CourseNum,'.aspx?menulanguage=en-gb',sep='')
GradeLinks <- paste('http://www.kurser.dtu.dk/courses/',CourseNum,'/info/default.aspx',sep='')
GradeLinks2 <- paste('http://karakterer.dtu.dk/Histogram/1/',CourseNum,'/',Period,sep='')
jj <- 1
CourseType <- rep(0,length(GeneralLinks))
ECTS <- rep(0,length(GeneralLinks))
Department <- rep(0,length(GeneralLinks))
SecondaryDepartment <- rep(0,length(GeneralLinks))
AverageGrade <- rep(0,length(GeneralLinks))
#TempHist <- rep(0,c(100,100))
for (ii in GeneralLinks){
res<-try(ECTS[jj]<-ii %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) .value') %>%
html_text,silent=TRUE)
if (inherits(res,'try-error')){
ECTS[jj]<-ii %>%
html() %>%
html_nodes('.normal+ table tr:nth-child(4) .value') %>%
html_text
}else{
ECTS[jj]<-ii %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) .value') %>%
html_text
}
CourseTypeTemp <- ii %>%
html() %>%
html_nodes('.value div:nth-child(1)') %>%
html_text
CourseType[jj] <- CourseTypeTemp[1]
Department[jj] <- ii %>%
html() %>%
html_nodes('.SubTableLevel2 tr:nth-child(1) .page+ td') %>%
html_text
res2<-try(SecondaryDepartment[jj]<-ii %>%
html() %>%
html_nodes('#pagecontents tr:nth-child(2) div') %>%
html_text,silent=TRUE)
if (inherits(res2,'try-error')){
SecondaryDepartment[jj] <- 'No'
}else{
SecondaryDepartment[jj]<-ii %>%
html() %>%
html_nodes('#pagecontents tr:nth-child(2) div') %>%
html_text
}
AverageGrade[jj] <- GradeLinks2[jj] %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) td+ td') %>%
html_text
#for (kk in TempHist){
#}
jj<-jj+1
}
rownames(df)<-categories
df$ECTS <- ECTS
df$CourseType <- CourseType
df$Department <- gsub('[\r\n]','',Department)
df$SecondaryDepartment <- gsub('[\r\n]','',SecondaryDepartment)
AverageGradeTemp <- gsub('[\r\n (Efter7 trinsskalaen) ]','',AverageGrade)
df$AverageGrade <- gsub('-','',AverageGradeTemp)
df[1]
df[2]
df[3]
df[4]
df[5]
df[6]
df[5]
as.numeric(df[5])
as.list(df[5])
a<-as.list(df[5])
a
a[1]
a[[1]]
as.numeric(a[[1]])
lol <- gsub('[\r\n (Efter7 trinsskalaen) ]','',AverageGrade)
lol
lol2<-gsub('-','',lol)
lol2
lol3 <- gsub(',','.',lol2)
lol3
as.numeric(lol3)
rm(list=ls())
require(rvest)
url<- 'http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E&YearGroup=2014-2015,2015-2016&btnSearch=Search'
categories <- url %>%
html() %>%
html_nodes('#ctl00_PlaceHolderMain_PageHtml td div a') %>%
html_text()
categories<-unique(categories[200:210])
departments <- url %>%
html() %>%
html_nodes('#lstDepartment option') %>%
html_text()
categories
rm(list=ls())
require(rvest)
## Fall semester
url<- 'http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E&YearGroup=2014-2015,2015-2016&btnSearch=Search'
categories <- url %>%
html() %>%
html_nodes('#ctl00_PlaceHolderMain_PageHtml td div a') %>%
html_text()
categories<-unique(categories[200:210])
departments <- url %>%
html() %>%
html_nodes('#lstDepartment option') %>%
html_text()
#Initialazing the data frame
Period <- 'Winter-2014'
df <- data.frame(matrix(nrow=length(categories),ncol=0))
CourseNum <- substring(categories,1,5)
GeneralLinks <- paste('http://www.kurser.dtu.dk/',CourseNum,'.aspx?menulanguage=en-gb',sep='')
GradeLinks <- paste('http://www.kurser.dtu.dk/courses/',CourseNum,'/info/default.aspx',sep='')
GradeLinks2 <- paste('http://karakterer.dtu.dk/Histogram/1/',CourseNum,'/',Period,sep='')
jj <- 1
CourseType <- rep(0,length(GeneralLinks))
ECTS <- rep(0,length(GeneralLinks))
Department <- rep(0,length(GeneralLinks))
SecondaryDepartment <- rep(0,length(GeneralLinks))
AverageGrade <- rep(0,length(GeneralLinks))
#TempHist <- rep(0,c(100,100))
for (ii in GeneralLinks){
res<-try(ECTS[jj]<-ii %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) .value') %>%
html_text,silent=TRUE)
if (inherits(res,'try-error')){
ECTS[jj]<-ii %>%
html() %>%
html_nodes('.normal+ table tr:nth-child(4) .value') %>%
html_text
}else{
ECTS[jj]<-ii %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) .value') %>%
html_text
}
CourseTypeTemp <- ii %>%
html() %>%
html_nodes('.value div:nth-child(1)') %>%
html_text
CourseType[jj] <- CourseTypeTemp[1]
Department[jj] <- ii %>%
html() %>%
html_nodes('.SubTableLevel2 tr:nth-child(1) .page+ td') %>%
html_text
res2<-try(SecondaryDepartment[jj]<-ii %>%
html() %>%
html_nodes('#pagecontents tr:nth-child(2) div') %>%
html_text,silent=TRUE)
if (inherits(res2,'try-error')){
SecondaryDepartment[jj] <- 'No'
}else{
SecondaryDepartment[jj]<-ii %>%
html() %>%
html_nodes('#pagecontents tr:nth-child(2) div') %>%
html_text
}
AverageGrade[jj] <- GradeLinks2[jj] %>%
html() %>%
html_nodes('h2+ table tr:nth-child(4) td+ td') %>%
html_text
#for (kk in TempHist){
res3<-try(SecondaryDepartment[jj]<-ii %>%
html() %>%
html_nodes('#pagecontents tr:nth-child(2) div') %>%
html_text,silent=TRUE)
if (inherits(res3,'try-error')){
SecondaryDepartment[jj] <- 'No'
}else{
SecondaryDepartment[jj]<-ii %>%
html() %>%
html_nodes('#pagecontents tr:nth-child(2) div') %>%
html_text
}
#}
jj<-jj+1
}
rownames(df)<-categories
df$ECTS <- ECTS
df$CourseType <- CourseType
df$Department <- gsub('[\r\n]','',Department)
df$SecondaryDepartment <- gsub('[\r\n]','',SecondaryDepartment)
AverageGradeTemp <- gsub('[\r\n (Efter7 trinsskalaen) ]','',AverageGrade)
AverageGradeTemp <- gsub(',','.',AverageGradeTemp)
df$AverageGrade <- gsub('-','',AverageGradeTemp)
rm(list=ls())
require(rvest)
## Fall semester
url<- 'http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E&YearGroup=2014-2015,2015-2016&btnSearch=Search'
categories <- url %>%
html() %>%
html_nodes('#ctl00_PlaceHolderMain_PageHtml td div a') %>%
html_text()
categories<-unique(categories[200:210])
departments <- url %>%
html() %>%
html_nodes('#lstDepartment option') %>%
html_text()
#Initialazing the data frame
rm(list=ls())
require(rvest)
## Fall semester
url<- 'http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E&YearGroup=2014-2015,2015-2016&btnSearch=Search'
categories <- url %>%
html() %>%
html_nodes('#ctl00_PlaceHolderMain_PageHtml td div a') %>%
html_text()
categories<-unique(categories[200:210])
departments <- url %>%
html() %>%
html_nodes('#lstDepartment option') %>%
html_text()
rm(list=ls())
require(rvest)
url<- 'http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E&YearGroup=2014-2015,2015-2016&btnSearch=Search'
categories <- url %>%
html() %>%
html_nodes('#ctl00_PlaceHolderMain_PageHtml td div a') %>%
html_text()
categories<-unique(categories[200:210])
departments <- url %>%
html() %>%
html_nodes('#lstDepartment option') %>%
html_text()
rm(list=ls())
require(rvest)
library(stringi)
library(RCurl)
setwd('C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject')
source('GetUrlData.R')
url<-paste0('http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;',
'E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E;F1;F2;F3;F4;F5;F1A;F2A;F3A;F4A;F5A;F1B;',
'F2B;F3B;F4B;F5B;F&YearGroup=2014-2015,2015-2016&btnSearch=Search&menulanguage=en-GB')
state_GetCourse<-'#ctl00_PlaceHolderMain_PageHtml td div a'
state_GetDepartments <- '#lstDepartment option'
state_GetECTS <- 'h2+ table tr:nth-child(4) .value'
state_GetECTS2 <- '.normal+ table tr:nth-child(4) .value'
state_CourseTypr <- '.value div:nth-child(1)'
state_CourseTypr2 <-'.normal+ table tr:nth-child(5) .value'
state_GetDepartment <- '.SubTableLevel2 tr:nth-child(1) .page+ td'
state_GetDepartmentSecondary <- '#pagecontents tr:nth-child(2) div'
state_PeriodNumber <- 'span td+ td'
categories<-GetUrlData(urlPath=url,state=state_GetCourse)
categories<-unique(categories)
depatments<-GetUrlData(urlPath=url,state=state_GetDepartments)
CourseNum <- substring(categories,1,5)
df <- data.frame(matrix(nrow=length(categories),ncol=0))
CourseInfoLinks <- paste('http://www.kurser.dtu.dk/',CourseNum,'.aspx?menulanguage=en-gb',sep='')
GradeLinks <- paste('http://www.kurser.dtu.dk/courses/',CourseNum,'/info/default.aspx',sep='')
CourseType <- rep(0,length(CourseInfoLinks))
ECTS <- rep(0,length(CourseInfoLinks))
Department <- rep(0,length(CourseInfoLinks))
SecondaryDepartment <- rep(0,length(CourseInfoLinks))
jj <- 1
for (ii in CourseInfoLinks){
if (url.exists(ii)){
#get ECTS credits
res<-try(ECTS[jj]<-GetUrlData(urlPath=ii,state_GetECTS),silent=TRUE)
resB<-try(ECTS[jj]<-GetUrlData(urlPath=ii,state_GetECTS2),silent=TRUE)
if (inherits(res,'try-error')){
ECTS[jj]<- GetUrlData(urlPath=ii,state_GetECTS2)
}else if(inherits(resB,'try-error')){
ECTS[jj]<-GetUrlData(urlPath=ii,state_GetECTS)
}else{
ECTS[jj]<-NA
}
#get CourseType credits
res2 <- try(CourseType[jj]<-GetUrlData(urlPath=ii,state_CourseTypr),silent=TRUE)
if (inherits(res2,'try-error')){
CourseType[jj] <- NA
}else{
CourseTypeTemp <- GetUrlData(urlPath=ii,state_CourseTypr)
CourseType[jj] <- CourseTypeTemp[1]
}
# get Deparment and secondary
res3 <- try(Department[jj]<-GetUrlData(urlPath=ii,state_GetDepartment),silent=TRUE)
if (inherits(res3,'try-error')){
Department[jj] <- NA
}else{
Department[jj] <- GetUrlData(urlPath=ii,state_GetDepartment)
}
res4<-try(SecondaryDepartment[jj]<-GetUrlData(urlPath=ii,state_GetDepartmentSecondary),silent=TRUE)
if (inherits(res4,'try-error')){
SecondaryDepartment[jj] <- 'No'
}else{
SecondaryDepartment[jj]<-GetUrlData(urlPath=ii,state_GetDepartmentSecondary)
}
}else{
ECTS[jj]<- NA
CourseType[jj]<- NA
Department[jj]<- NA
SecondaryDepartment[jj]<- NA
}
jj<-jj+1
}
rm(list=ls())
require(rvest)
library(stringi)
library(RCurl)
setwd('C:/Users/Dimitrios/Documents/Dimitris_general/R programming my projects/DTUprject')
source('GetUrlData.R')
url<-paste0('http://www.kurser.dtu.dk/search.aspx?lstTeachingPeriod=E1;E2;E3;E4;E5;E1A;',
'E2A;E3A;E4A;E5A;E1B;E2B;E3B;E4B;E5B;E;F1;F2;F3;F4;F5;F1A;F2A;F3A;F4A;F5A;F1B;',
'F2B;F3B;F4B;F5B;F&YearGroup=2014-2015,2015-2016&btnSearch=Search&menulanguage=en-GB')
state_GetCourse<-'#ctl00_PlaceHolderMain_PageHtml td div a'
state_GetDepartments <- '#lstDepartment option'
state_GetECTS <- 'h2+ table tr:nth-child(4) .value'
state_GetECTS2 <- '.normal+ table tr:nth-child(4) .value'
state_CourseTypr <- '.value div:nth-child(1)'
state_CourseTypr2 <-'.normal+ table tr:nth-child(5) .value'
state_GetDepartment <- '.SubTableLevel2 tr:nth-child(1) .page+ td'
state_GetDepartmentSecondary <- '#pagecontents tr:nth-child(2) div'
state_PeriodNumber <- 'span td+ td'
categories<-GetUrlData(urlPath=url,state=state_GetCourse)
categories<-unique(categories)
categories<-GetUrlData(urlPath=url,state=state_GetCourse)
